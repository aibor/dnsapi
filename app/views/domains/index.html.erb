<h1>
  Domains
  <%= button_to t('c.new'), new_domain_path, class: "btn btn-primary", method: :get %>
</h1>

<table class="table table-striped">
  <thead>
    <tr>
      <th>
        <%= t('domains.columns.name') %>
      </th>

      <th>
        <%= t('domains.columns.records') %>
      </th>

      <th>
        <%= t('domains.columns.master') %>
      </th>

      <th>
        <%= t('domains.columns.last_check') %>
      </th>

      <th>
        <%= t('domains.columns.type') %>
      </th>

      <th>
        <%= t('domains.columns.notified_serial') %>
      </th>

      <% if @current_user.admin %>
      <th>
        <%= t('domains.columns.users') %>
      </th>
      <% end %>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @domains.each do |domain| %>
      <tr>
        <td>
          <%= link_to domain.name, domain, title: t('.show', domain: domain.name) %>
          <% if domain.cryptokeys.any? -%>
            <span class="label label-success pull-right" title="<%= t('.dnssec') %>">
              <span class="glyphicon glyphicon-flag"></span>
            </span>
          <% end -%>
        </td>

        <td class="text-center">
          <%= domain.records.count %>
        </td>

        <td>
          <%= domain.master %>
        </td>
        
        <td>
          <%= domain.last_check %>
        </td>

        <td>
          <%= domain.type %>
        </td>

        <td>
          <%= domain.notified_serial %>
        </td>

      <% if @current_user.admin %>
        <td>
          <%= raw domain.users.map(&:username).join("<br>") %>
        </td>
      <% end %>

        <td>
          <%= link_to edit_domain_path(domain),
            title: t('.edit', domain: domain.name) do %>
              <span class="glyphicon glyphicon-edit"></span>
          <% end %>
        </td>

        <td>
          <%= link_to delete_domain_path(domain),
            title: t('.delete', domain: domain.name) do %>
              <span class="glyphicon glyphicon-remove"></span>
          <% end%>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
